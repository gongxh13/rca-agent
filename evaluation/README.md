# RCA Agent 评估仪表盘

## 📊 历史评估结果

| 日期 | Agent模式 | 变更内容 | 平均耗时 | 总 Token | 输入 Token | 输入缓存 Token | 输出 Token | 组件+原因+时间 (全对) | 组件+原因 | 仅组件 | 仅原因 | 仅时间 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **2026-01-23** | baseline | - | 991s | 347k | 332k | 285k | 16k | 9.68% | 9.68% | 24.19% | 16.13% | 27.42% |
| **2026-01-23** | baseline | - | 991s | 347k | 332k | 285k | 16k | 9.68% | 9.68% | 24.19% | 16.13% | 27.42% |
| **2026-01-23** | baseline | - | 991s | 347k | 332k | 285k | 16k | 9.68% | 9.68% | 24.19% | 16.13% | 27.42% |

> **注意**: 指标基于严格的“集合相等”匹配。如果一个任务有多个根因，必须全部识别正确才算成功。
> *所有测试均默认使用 `deepseek-chat` 模型。*

---

## 🛠 评估方法论

我们的评估框架针对 OpenRCA 基准数据集（Bank场景）进行严格测试。评估采用**严格集合匹配（Strict Set Matching）**策略，确保不仅能发现根因，还能避免误报（Hallucination）。

### 1. 匹配标准 (Matching Criteria)

对于每一个预测的故障记录，必须在以下三个维度上与标准答案完全一致：

*   **🧩 组件 (Component)**:
    *   **判定**: 精确字符串匹配 (去空格，区分大小写)。
    *   **示例**: `Tomcat04`, `Mysql02`。
*   **💡 原因 (Reason)**:
    *   **判定**: 精确字符串匹配。
    *   **示例**: `JVM Out of Memory (OOM) Heap`, `high CPU usage`。
*   **⏰ 时间 (Time)**:
    *   **判定**: 绝对误差 ≤ 5分钟 (300秒)。
    *   **说明**: 预测的时间戳必须落在标准答案的 ±5分钟 窗口内。

### 2. 任务级成功判定 (Task-Level Success)

一个评估任务（通常对应一个30分钟的时间窗口）被判定为 **Correct**，当且仅当该窗口内的**预测故障集合**与**标准答案集合**完全相等。

*   **无漏报 (Recall)**: 必须找出窗口内所有的真实故障。
*   **无误报 (Precision)**: 不能预测出不存在的故障。

### 3. 指标定义

| 指标 | 定义 |
| :--- | :--- |
| **组件+原因+时间 (全对)** | 🥇 金标准。要求所有故障的组件、原因和时间都完美匹配。 |
| **组件+原因** | 要求组件和原因匹配（忽略时间误差）。 |
| **仅组件** | 仅要求正确识别出故障组件集合。 |
| **仅原因** | 仅要求正确识别出故障原因描述集合。 |
| **仅时间** | 仅要求正确识别出故障发生的时间点集合。 |

---

## 📈 趋势分析

> **说明**: 
> *   `baseline`: 性能通常保持稳定（水平线）。
> *   `rca`: 随着Agent的迭代优化，性能曲线应呈现波动上升趋势。

### 核心准确率趋势 (RCA vs Baseline)

```mermaid
xychart-beta
    title "准确率趋势 (Baseline: 9.68%)"
    x-axis ["01-23", "01-23", "01-23"]
    y-axis "准确率 (%)" 0 --> 100
    line [9.68, 9.68, 9.68]
    line [9.68, 9.68, 9.68]
```

### 组件+原因 准确率 (RCA vs Baseline)

```mermaid
xychart-beta
    title "组件+原因 准确率 (Baseline: 9.68%)"
    x-axis ["01-23", "01-23", "01-23"]
    y-axis "准确率 (%)" 0 --> 100
    line [9.68, 9.68, 9.68]
    line [9.68, 9.68, 9.68]
```

### 诊断细分: 仅组件准确率 (RCA vs Baseline)

```mermaid
xychart-beta
    title "仅组件准确率 (Baseline: 24.19%)"
    x-axis ["01-23", "01-23", "01-23"]
    y-axis "准确率 (%)" 0 --> 100
    line [24.19, 24.19, 24.19]
    line [24.19, 24.19, 24.19]
```

### 诊断细分: 仅原因准确率 (RCA vs Baseline)

```mermaid
xychart-beta
    title "仅原因准确率 (Baseline: 16.13%)"
    x-axis ["01-23", "01-23", "01-23"]
    y-axis "准确率 (%)" 0 --> 100
    line [16.13, 16.13, 16.13]
    line [16.13, 16.13, 16.13]
```

### 时间定位准确率 (RCA vs Baseline)

```mermaid
xychart-beta
    title "时间定位准确率 (Baseline: 27.42%)"
    x-axis ["01-23", "01-23", "01-23"]
    y-axis "准确率 (%)" 0 --> 100
    line [27.42, 27.42, 27.42]
    line [27.42, 27.42, 27.42]
```

### 平均耗时 (RCA vs Baseline)

```mermaid
xychart-beta
    title "平均耗时 (Baseline: 991s)"
    x-axis ["01-23", "01-23", "01-23"]
    y-axis "耗时 (s)" 0 --> 1189
    line [991, 991, 991]
    line [991, 991, 991]
```

### 资源消耗 (Resource Usage)

```mermaid
xychart-beta
    title "平均 Token 消耗 (千)"
    x-axis ["01-23", "01-23", "01-23"]
    y-axis "Tokens (k)" 0 --> 416
    line [347, 347, 347]
```

---

## 🤖 模型与配置

*   **Agent 模式**:
    *   `baseline`: 标准 OpenRCA 提示词策略。
    *   `rca`: 增强版 RCA Agent，具备高级工具链和多步推理能力。
*   **LLM 提供商**: DeepSeek / OpenAI (通过 `config.yaml` 配置)
*   **并发控制**: 默认 5 线程并发评估

---

*最后更新: 2026-01-23*
